{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/trader/lib/trading/equity.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nfunction env(name: string): string {\r\n  const v = process.env[name];\r\n  if (!v) throw new Error(`Missing env var: ${name}`);\r\n  return v;\r\n}\r\n\r\nfunction sbAdmin() {\r\n  return createClient(env(\"SUPABASE_URL\"), env(\"SUPABASE_SERVICE_ROLE_KEY\"), {\r\n    auth: { persistSession: false },\r\n  });\r\n}\r\n\r\n/**\r\n * Records a mark-to-market equity snapshot for an account\r\n * Equity = cash + realized + unrealized (from latest candle close)\r\n */\r\nexport async function recordEquityPoint(\r\n  accountId: string,\r\n  priceTimeframe: string = \"15m\",\r\n  note?: string\r\n) {\r\n  const sb = sbAdmin();\r\n\r\n  const { data, error } = await sb.rpc(\"compute_account_equity\", {\r\n    p_account_id: accountId,\r\n    p_price_timeframe: priceTimeframe,\r\n  });\r\n\r\n  if (error) throw new Error(error.message);\r\n\r\n  const row = data?.[0];\r\n  if (!row) throw new Error(\"Equity computation returned no rows\");\r\n\r\n  await sb.from(\"trade_equity_points\").insert({\r\n    account_id: accountId,\r\n    equity_usd: row.equity_usd,\r\n    cash_usd: row.cash_usd,\r\n    note: note ?? null,\r\n  });\r\n\r\n  return row;\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,SAAS,IAAI,IAAY;IACvB,MAAM,IAAI,QAAQ,GAAG,CAAC,KAAK;IAC3B,IAAI,CAAC,GAAG,MAAM,IAAI,MAAM,CAAC,iBAAiB,EAAE,MAAM;IAClD,OAAO;AACT;AAEA,SAAS;IACP,OAAO,IAAA,gMAAY,EAAC,IAAI,iBAAiB,IAAI,8BAA8B;QACzE,MAAM;YAAE,gBAAgB;QAAM;IAChC;AACF;AAMO,eAAe,kBACpB,SAAiB,EACjB,iBAAyB,KAAK,EAC9B,IAAa;IAEb,MAAM,KAAK;IAEX,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,GAAG,GAAG,CAAC,0BAA0B;QAC7D,cAAc;QACd,mBAAmB;IACrB;IAEA,IAAI,OAAO,MAAM,IAAI,MAAM,MAAM,OAAO;IAExC,MAAM,MAAM,MAAM,CAAC,EAAE;IACrB,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAE1B,MAAM,GAAG,IAAI,CAAC,uBAAuB,MAAM,CAAC;QAC1C,YAAY;QACZ,YAAY,IAAI,UAAU;QAC1B,UAAU,IAAI,QAAQ;QACtB,MAAM,QAAQ;IAChB;IAEA,OAAO;AACT"}},
    {"offset": {"line": 85, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/trader/app/api/execute/route.ts"],"sourcesContent":["import \"server-only\";\r\nimport { NextResponse } from \"next/server\";\r\nimport { createClient } from \"@supabase/supabase-js\";\r\nimport { recordEquityPoint } from \"../../../lib/trading/equity\";\r\n\r\n\r\nexport const runtime = \"nodejs\";\r\nexport const dynamic = \"force-dynamic\";\r\nexport const revalidate = 0;\r\n\r\ntype ExecuteRequest = {\n  accountId: string;          // trade_accounts.id\n  clientOrderId: string;      // idempotency key (use analysis_runs.id)\n  symbol: string;             // BTCUSDT (we map to BTCUSDT-PERP)\n  priceTimeframe?: string;    // candle tf for fill/equity mark (default \"15m\")\n  feeUsd?: number;            // optional flat fee for paper (default 0)\n  decisionId?: string;        // optional link to decision_logs.id\n  plan: {\n    action: \"NO_TRADE\" | \"LONG\" | \"SHORT\";\n    leverage: number;\n    entry: { type: \"market\" | \"limit\" | \"stop\"; price?: number; trigger?: number };\n    stop: { price: number; rationale: string };\n    targets: Array<{ price: number; sizePct: number }>;\n    riskPct: number;\n    notes?: string;\n  };\n};\n\r\nfunction env(name: string): string {\r\n  const v = process.env[name];\r\n  if (!v) throw new Error(`Missing env var: ${name}`);\r\n  return v;\r\n}\r\n\r\nfunction sbAdmin() {\r\n  return createClient(env(\"SUPABASE_URL\"), env(\"SUPABASE_SERVICE_ROLE_KEY\"), {\r\n    auth: { persistSession: false },\r\n  });\r\n}\r\n\r\nfunction toPerp(sym: string) {\r\n  const s = sym.trim().toUpperCase();\r\n  return s.endsWith(\"-PERP\") ? s : `${s}-PERP`;\r\n}\r\n\r\nfunction clamp(n: number, lo: number, hi: number) {\r\n  return Math.max(lo, Math.min(hi, n));\r\n}\r\n\r\nexport async function POST(req: Request) {\r\n  const sb = sbAdmin();\r\n\r\n  try {\r\n    const body = (await req.json()) as ExecuteRequest;\r\n\r\n    if (!body.accountId) return NextResponse.json({ ok: false, error: \"accountId required\" }, { status: 400 });\r\n    if (!body.clientOrderId) return NextResponse.json({ ok: false, error: \"clientOrderId required\" }, { status: 400 });\r\n    if (!body.symbol) return NextResponse.json({ ok: false, error: \"symbol required\" }, { status: 400 });\r\n    if (!body.plan) return NextResponse.json({ ok: false, error: \"plan required\" }, { status: 400 });\r\n\r\n    const symbol = toPerp(body.symbol);\r\n    const tf = (body.priceTimeframe ?? \"15m\").toLowerCase();\r\n    const feeUsd = Number.isFinite(body.feeUsd ?? NaN) ? (body.feeUsd as number) : 0;\r\n\r\n    // NO_TRADE => no execution\r\n    if (body.plan.action === \"NO_TRADE\") {\r\n      return NextResponse.json({ ok: true, status: \"no_trade\" }, { status: 200 });\r\n    }\r\n\r\n    const side = body.plan.action === \"LONG\" ? \"buy\" : \"sell\";\r\n\r\n    // Fill price from latest candle close\r\n    const { data: lastCandle, error: candleErr } = await sb\r\n      .from(\"candles\")\r\n      .select(\"close\")\r\n      .eq(\"symbol\", symbol)\r\n      .eq(\"timeframe\", tf)\r\n      .order(\"open_time\", { ascending: false })\r\n      .limit(1)\r\n      .maybeSingle();\r\n\r\n    if (candleErr) throw new Error(`Candle lookup failed: ${candleErr.message}`);\r\n\r\n    const fillPrice = Number(lastCandle?.close);\r\n    if (!Number.isFinite(fillPrice) || fillPrice <= 0) {\r\n      return NextResponse.json({ ok: false, error: \"No candle price available to fill.\" }, { status: 422 });\r\n    }\r\n\r\n    // Account cash (for sizing baseline)\r\n    const { data: acct, error: acctErr } = await sb\r\n      .from(\"trade_accounts\")\r\n      .select(\"id,cash_balance\")\r\n      .eq(\"id\", body.accountId)\r\n      .single();\r\n\r\n    if (acctErr) throw new Error(`Account lookup failed: ${acctErr.message}`);\r\n\r\n    const cash = Number(acct.cash_balance);\r\n    if (!Number.isFinite(cash) || cash <= 0) {\r\n      return NextResponse.json({ ok: false, error: \"Account cash_balance invalid.\" }, { status: 422 });\r\n    }\r\n\r\n    // Paper sizing:\r\n    // risk$ = cash * riskPct\r\n    // qty = risk$ / |entry-stop|\r\n    const entry = fillPrice;\r\n    const stop = Number(body.plan.stop.price);\r\n    const stopDist = Math.abs(entry - stop);\r\n\r\n    if (!Number.isFinite(stop) || stop <= 0) {\r\n      return NextResponse.json({ ok: false, error: \"Invalid stop price in plan.\" }, { status: 422 });\r\n    }\r\n    if (stopDist <= 0) {\r\n      return NextResponse.json({ ok: false, error: \"Stop distance is zero.\" }, { status: 422 });\r\n    }\r\n\r\n    const riskPct = clamp(Number(body.plan.riskPct), 0, 5);\r\n    const riskUsd = cash * (riskPct / 100);\r\n\r\n    const qty = riskUsd / stopDist;\r\n    if (!Number.isFinite(qty) || qty <= 0) {\r\n      return NextResponse.json({ ok: false, error: \"Computed qty invalid.\" }, { status: 422 });\r\n    }\r\n\r\n    const leverage = clamp(Number(body.plan.leverage), 1, 25);\r\n\r\n    // Idempotent order insert\n    const { data: order, error: orderErr } = await sb\n      .from(\"trade_orders\")\n      .insert({\n        account_id: body.accountId,\n        client_order_id: body.clientOrderId,\n        symbol,\n        side,\n        type: \"market\",\n        qty,\n        leverage,\n        status: \"new\",\n      })\n      .select(\"*\")\n      .single();\n\r\n    if (orderErr) {\n      // duplicate idempotency key => return existing\r\n      const { data: existing } = await sb\r\n        .from(\"trade_orders\")\r\n        .select(\"*\")\r\n        .eq(\"account_id\", body.accountId)\r\n        .eq(\"client_order_id\", body.clientOrderId)\r\n        .maybeSingle();\r\n\r\n      if (existing) {\r\n        return NextResponse.json({ ok: true, idempotent: true, order: existing }, { status: 200 });\r\n      }\r\n      throw new Error(`Order insert failed: ${orderErr.message}`);\n    }\n\n    // Try to link this order to a decision log (best effort)\n    try {\n      if (body.decisionId) {\n        await sb.from(\"trade_orders\").update({ decision_id: body.decisionId }).eq(\"id\", order.id);\n      } else {\n        const { data: decision } = await sb\n          .from(\"decision_logs\")\n          .select(\"id\")\n          .eq(\"symbol\", symbol)\n          .order(\"created_at\", { ascending: false })\n          .limit(1)\n          .maybeSingle();\n        if (decision?.id) {\n          await sb.from(\"trade_orders\").update({ decision_id: decision.id }).eq(\"id\", order.id);\n        }\n      }\n    } catch {\n      // ignore if column doesn't exist\n    }\n\n    // Create fill\n    const { error: fillErr } = await sb.from(\"trade_fills\").insert({\n      order_id: order.id,\n      account_id: body.accountId,\n      symbol,\n      side,\n      qty,\n      price: fillPrice,\n      fee_usd: feeUsd,\n    });\n\r\n    if (fillErr) throw new Error(`Fill insert failed: ${fillErr.message}`);\n\n    // Trade journal entry (best effort)\n    try {\n      await sb.from(\"trade_journal\").insert({\n        account_id: body.accountId,\n        symbol,\n        side,\n        qty,\n        entry_price: fillPrice,\n        entry_time: new Date().toISOString(),\n        decision_id: body.decisionId ?? null,\n        order_id: order.id,\n        status: \"open\",\n      });\n    } catch {\n      // ignore if table missing\n    }\n\r\n    // Apply fill -> position + cash (fees)\r\n    const { error: applyErr } = await sb.rpc(\"apply_fill_to_position_and_cash\", {\r\n      p_account_id: body.accountId,\r\n      p_symbol: symbol,\r\n      p_side: side,\r\n      p_qty: qty,\r\n      p_price: fillPrice,\r\n      p_fee_usd: feeUsd,\r\n    });\r\n\r\n    if (applyErr) throw new Error(`apply_fill_to_position_and_cash failed: ${applyErr.message}`);\r\n\r\n    // Mark order filled\r\n    const { error: updErr } = await sb\r\n      .from(\"trade_orders\")\r\n      .update({ status: \"filled\" })\r\n      .eq(\"id\", order.id);\r\n\r\n    if (updErr) throw new Error(`Order status update failed: ${updErr.message}`);\r\n\r\n    // Record *true* equity point (cash + realized + unrealized)\n    const eq = await recordEquityPoint(\n      body.accountId,\n      tf,\n      `fill ${symbol} ${side} qty=${qty} price=${fillPrice}`\n    );\n\n    // Persist position risk (stop/targets/max loss)\n    try {\n      const maxLossPct = clamp(Math.max(Number(body.plan.riskPct ?? 1), 1), 0.5, 5);\n      await sb.from(\"position_risk\").upsert(\n        {\n          account_id: body.accountId,\n          symbol,\n          stop_price: Number(body.plan.stop?.price ?? 0),\n          targets: body.plan.targets ?? [],\n          max_loss_pct: maxLossPct,\n          note: body.plan.notes ?? null,\n        },\n        { onConflict: \"account_id,symbol\" }\n      );\n    } catch {\n      // ignore if table doesn't exist\n    }\n\n    return NextResponse.json(\n      {\n        ok: true,\r\n        orderId: order.id,\r\n        fill: { price: fillPrice, qty, feeUsd },\r\n        equity: eq,\r\n      },\r\n      { status: 200 }\r\n    );\r\n  } catch (e) {\r\n    return NextResponse.json({ ok: false, error: (e as Error).message }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}}]
}